## PCORnet CDM V1

The PCORnet common data model was last released by PCORI on May 30th 2014 in both PDF and "parseable" MS Excel formats, but without database definition language for specific implementation. The DDL contained here represents an interpretation of the released materials, translated into several database dialects for the use of PEDSnet members. The full released documentation on the PCORnet CDM can be found in the [docs](docs) directory.

### Database Dialects

DDL scripts for creating the PCORnet CDM V1 are available for:

- PostgreSQL at [PCORnet_CDM_V1_pgsql.ddl](PCORnet_CDM_V1_pgsql.ddl)
- MySQL at [PCORnet_CDM_V1_mysql.ddl](PCORnet_CDM_V1_mysql.ddl)
- Oracle at [PCORnet_CDM_V1_oracle.ddl](PCORnet_CDM_V1_oracle.ddl)
- MS SQL Server at [PCORnet_CDM_V1_mssql.ddl](PCORnet_CDM_V1_mssql.ddl)

These scripts were generated by creating a declarative representation of the CDM using [SQLAlchemy](http://www.sqlalchemy.org/) syntax (in [sqlalchemy_cdm_tables.py](sqlalchemy_cdm_tables.py)) and programmatically converting it into dialect-specific DDL. For this reason, the scripts are not yet fully tested. Please report any issues [here](https://github.com/PCORnet/Data_Models/issues).

To re-generate the CDM DDL in the various dialects using the sqlalchemy CDM table definition file:

1. Install python requirements with `pip install -r requirements.txt`
2. Run the generation script with `python generate_cdm_ddl_dialects.py`

### Interpretations of PCORnet CDM V1

1. Where `TEXT(x)` appears as a data type in the PCORnet CDM specification, it has been interpreted as `VARCHAR` (or equivalent) type with a max length of 1028 characters.
2. Primary key constraints have been added to all tables, using the fields mentioned as unique for each table in the specification (SQLAlchemy table definitions require a primary key).
3. No constraints or checks have been added to enforce the formatting or value sets declared on columns in the specification (this is an area for possible future improvement).
4. No foreign key constraints have been added to enforce referential integrity on the relationships between tables mentioned in the specification (another area for possible future work).
5. An auto-incrementing integer primary key called `vitalid` is added to the vital table.
