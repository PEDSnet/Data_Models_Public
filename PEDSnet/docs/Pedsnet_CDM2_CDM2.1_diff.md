## Differences between PEDSnet CDM2 and CDM2.1

## CHANGES from CDM2.0

#### New Network Conventions and General information
1. **For populating `'*_source_concept_id'` use the following Logic:**

  **Populate `'*_source_concept_id'` (i.e. non-zero) if the source_value is drawn from a standard vocabulary in OMOP**.
Please use your local system knowledge to determine this or use the following criteria : All the values in the source_value field should be drawn from the concept_code in the concept table (for a given/relevant domain_id and a given vocabulary_id).
  **ELSE Use 0** 
 (usually the case when the sites need to "manually" map the foo_source_value to foo_concept_id)

2. Changed the table structure. Added columns `Foreign Key/Not Null Constraint` and `Required` to provide a better guide for when/how to provide fields.

####Specific Table Changes
####[1.2 Death](Pedsnet_CDM_ETL_Conventions.md#12-death-1)
1. Addition of `death_impute_concept_id` field and applicable PEDSNet concept values as value options.

####[1.6 Visit Occurrence ](Pedsnet_CDM_ETL_Conventions.md#16-visit_occurrence)
1. Additon of convention for `visit_end_time` to assert 11:59pm  as the end time for dates that have no time assoicated with them in the source system.

####[1.7 Condition Occurrence](Pedsnet_CDM_ETL_Conventions.md#17-condition_occurrence)
1. Additon of convention for `condition_end_time` to assert 11:59pm  as the end time for dates that have not time assoicated with them in the source system.
2. Addition of a more specific convention for populating the `condition_type_concept_id` for primary diagnosis, problem lsit diagnosis and all other diagnosis categories.
3. Updated the condition mapping information for ICD9-> SNOMED using the 'Maps to' relationship in the `concept_relatonship` table.

####[1.8 Procedure Occurrence](Pedsnet_CDM_ETL_Conventions.md#18-procedure_occurrence)
1. Clarified inclusion criteria for the procedure occurrence table.
2. Addition of convention for `procedure_type_concept_id` to map all procedure values to the EHR order list entry concept: 38000275.

####[1.9 Observation](Pedsnet_CDM_ETL_Conventions.md#19-observation-1)
1. Sites will not provide Chart availability and Biobank availability flags. This will be generated by the DCC.
2. Tobacco and Tobacco type concept mappings complete (see Observation - Table 1). 
3. Addition of tobacco domain, Smoking (see Observation - Table 1).
4. Addition of convention to inlcude APR-DRGs if availbale in the source.
5. Addition of general expections on the frequency and prevelance of admission source, discharge disposition, discharge status, and DRG observation records.
6. Examples provided on how to populate the Observation and Fact Relationship tables for Tobacco, Tobacco Type and Smoking.


####[1.11 Drug Exposure](Pedsnet_CDM_ETL_Conventions.md#111-drug-exposure-1)
1. Examples provided on how to populate `effective_drug_dose`, `dose_unit_concept_id` and `dose_unit_source_value` based on values in the source.
2. Examples provided on how to populate `drug_source_value`, `drug_source_concept_id` and `drug_concept_id` based on values in the source.
3. Additon of convention for `drug_exposure_end_time` to assert 11:59pm  as the end time for dates that have not time assoicated with them in the source system.
4. Addition of `drug_exposure_order_date` and `drug_exposure_order_time` columns
5. Addition of convention for `drug_exposure_start_date`: If the start date of the drug is null in the source system, use the ordering date as the start date. No date shifting.
6. Addition of `effective_drug_dose_source_value` column to store the drug dose as it appears in the source.
7. Addition of `frequency` column to store the discrete frequency information as available from the source.
8. Clarification on providing Medication Administration Data. Each medication administration indiciative of a given medication must be reported.

####[1.12 Measurement](Pedsnet_CDM_ETL_Conventions.md#112-measurement-1)
1. Network listing finalized and referenced in the document. Can also be found [here] (https://github.com/PEDSnet/Data_Models/blob/master/PEDSnet/docs/PEDSnet_Component_Loinc_Mapping.xlsx).
2. Updated `measurement_type_concept_id` applicable values to include "Vital Sign from device direct feed and Vital sign from healthcare delivery setting options and also include the Lab Result measurement type.
3. Updated BP measurement and fact relationship table examples.
4. Addition of `range_low_source_value`, `range_low_operator_concept_id`, `range_high_source_value` and `range_high_operator_concept_id` columns
5. Addition of convention examples for populating `range_low`, `range_low_source_value`,`range_low_operator_concept_id`,`range_high`, `range_high_source_value`and `range_low_operator_concept_id` values
6. Updated the convention for `measurement_date` and `measurement_time` to store specimen collected time or performed time for lab results.
7. Addition of `measurement_order_date`, `measurement_order_time`, `measurement_result_date` and `measurement_result_time` columns
8. Updated the convention for `value_source_value` to store raw result values from the source for Categorical/Qualitative lab results.
9. Addition of `specimen_source_value` to store the specimen source as recorded in the source.

####[1.13 Fact Relationship](Pedsnet_CDM_ETL_Conventions.md#113-fact-relationship-1)
1. Addition of table notes to indicate ER Visits that result in an Inpateint Encounter and Tobacco,smoking and tobbacco type associations will be mapped using the fact relationship table.

####[1.14 Visit Payer](Pedsnet_CDM_ETL_Conventions.md#114-visit_payer)
1. Updated convention for populating `plan_type` and `plan_class`

## Removed from PEDSNet CDM2.1
####[1.9 Observation](Pedsnet_CDM_ETL_Conventions.md#19-observation-1)
1. Sites will not provide Chart availability and Biobank availability flags. This will be generated by the DCC.

***
## NEW in PEDSnet CDM2.1

The **PEDSNet** vocabulary is a new additon to the vocabulary snapshot provided by the DCC. This vocabulary is a supplment to the OMOP v5 vocabulary that contains specfic concepts that apply to PEDSNet data.

***
