--=============================================================================
--
-- NAME
--
-- i2b2_omop_base_data.sql
--
-- Author : Rajesh Ganta
-- Cincinnati Childrens Hospital Medical Center (CCHMC)
-- Date : 02/06/2015
--
-- SCHEMA / USER : OMOP_ETL
-- PEDSNET OMOP CDM Version : 1.0
-- Oracle Database 11g
--
-- DESCRIPTION:
-- Under OMOP_ETL schema run below insert statements.
-- For this release, had to change the concept_id(s) mapped from --> to mentioned
-- below mainly for "VISIT_OCCURRENCE" table, field 'PLACE_OF_SERVICE_CONCEPT_ID':
-- (IP) Inpatient Visit: Changed concept_id from 8717 --> 9201
-- (OA) Outpatient Visit: Changed concept_id from 8756 --> 9202
-- (ED) Emergency Room Visit: Changed concept_id from 8870 --> 9203
-- Added additional mapping concept_id(s) for DRGS of CMSDRG and MSDRG used for 
-- "OBSERVATION" table. Plus changed description value names for concepts of race,
-- ethnicity and gender, this will not affect the ETL values.
-- Truncating table omop_mapping and reloading with mapping details into omop_mapping 
-- table, provided insert scripts for to load into OMOP_MAPPING table.
--
--=============================================================================
SET DEFINE OFF;
TRUNCATE TABLE OMOP_MAPPING;
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('CONDITION_OCCURRENCE', 'CONDITION_TYPE_CONCEPT_ID', 'PDX:P', 'Primary Condition', 44786627, 
    'Primary Condition');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('CONDITION_OCCURRENCE', 'CONDITION_TYPE_CONCEPT_ID', 'PDX:OT', 'Secondary Condition', 44786629, 
    'Secondary Condition');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('DEATH', 'DEATH_TYPE_CONCEPT_ID', 'Deceased', 'Deceased', 38003569, 
    'EHR record patient status "Deceased"');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('DEATH', 'DEATH_TYPE_CONCEPT_ID', 'Not Recorded', 'Deceased', 38003569, 
    'EHR record patient status "Deceased"');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC, OBSERVATION_TYPE_CODE, OBSERVATION_TYPE_DESC)
 Values
   ('OBSERVATION', 'OBSERVATION_CONCEPT_ID', 'HT', 'Body height Measured', 3023540, 
    'Body height Measured', 38000280, 'Observation recorded from EHR');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC, OBSERVATION_TYPE_CODE, OBSERVATION_TYPE_DESC)
 Values
   ('OBSERVATION', 'OBSERVATION_CONCEPT_ID', 'CMSDRG', 'Hospital discharge DRG', 3040464, 
    'Hospital discharge DRG', 38000280, 'Observation recorded from EHR');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC, OBSERVATION_TYPE_CODE, OBSERVATION_TYPE_DESC)
 Values
   ('OBSERVATION', 'OBSERVATION_CONCEPT_ID', 'MSDRG', 'Hospital discharge DRG', 3040464, 
    'Hospital discharge DRG', 38000280, 'Observation recorded from EHR');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC, OBSERVATION_TYPE_CODE, OBSERVATION_TYPE_DESC)
 Values
   ('OBSERVATION', 'OBSERVATION_CONCEPT_ID', 'WT', 'Body weight Measured', 3013762, 
    'Body weight Measured', 38000280, 'Observation recorded from EHR');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC, OBSERVATION_TYPE_CODE, OBSERVATION_TYPE_DESC)
 Values
   ('OBSERVATION', 'OBSERVATION_CONCEPT_ID', 'ORIGINAL_BMI', 'Body mass index (BMI) [Ratio]', 3038553, 
    'Body mass index (BMI) [Ratio]', 38000280, 'Observation recorded from EHR');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('OBSERVATION', 'UNIT_CONCEPT_ID', 'LBS', 'kg', 9529, 
    'kilogram');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC, OBSERVATION_TYPE_CODE, OBSERVATION_TYPE_DESC)
 Values
   ('OBSERVATION', 'OBSERVATION_CONCEPT_ID', 'DIASTOLIC', 'Diastolic blood pressure', 3012888, 
    'Diastolic blood pressure', 38000280, 'Observation recorded from EHR');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC, OBSERVATION_TYPE_CODE, OBSERVATION_TYPE_DESC)
 Values
   ('OBSERVATION', 'OBSERVATION_CONCEPT_ID', 'SYSTOLIC', 'Systolic blood pressure', 3004249, 
    'Systolic blood pressure', 38000280, 'Observation recorded from EHR');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE)
 Values
   ('OBSERVATION', 'UNIT_CONCEPT_ID', 'NULL');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('OBSERVATION', 'UNIT_CONCEPT_ID', 'IN', 'cm', 8582, 
    'centimeter');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE)
 Values
   ('PERSON', 'ETHNICITY_CONCEPT_ID', 'NULL');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_CODE)
 Values
   ('PERSON', 'ETHNICITY_CONCEPT_ID', 'UN', 44814653);
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'WHITE', 'White', 8527, 
    'White');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'UNK', 'Unknown', 8552, 
    'Unknown');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'REFUSED', 'Refuse to answer', 44814660, 
    'Refuse to answer');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'OT', 'Other Race', 8522, 
    'Other Race');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'NI', 'No Information', 44814661, 
    'No Information');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'MULTI', 'Multiple Race', 44814659, 
    'Multiple Race');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'BLACK', 'Black or African American', 8516, 
    'Black or African American');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'ASIAN/PAC. ISL', 'Native Hawaiian or Other Pacific Islander', 8557, 
    'Native Hawaiian or Other Pacific Islander');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'ASIAN', 'Asian', 8515, 
    'Asian');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'AMER.INDIAN', 'American Indian or Alaska Native', 8657, 
    'American Indian or Alaska Native');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'RACE_CONCEPT_ID', 'NULL', 'UNK', 8552, 
    'Unknown');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'GENDER_CONCEPT_ID', 'UN', 'UNKNOWN', 8551, 
    'UNKNOWN');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'GENDER_CONCEPT_ID', 'NI', 'No Information', 44814667, 
    'No Information');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'GENDER_CONCEPT_ID', 'M', 'MALE', 8507, 
    'MALE');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'GENDER_CONCEPT_ID', 'F', 'FEMALE', 8532, 
    'FEMALE');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'ETHNICITY_CONCEPT_ID', 'HISPANIC', 'Hispanic or Latino', 38003563, 
    'Hispanic or Latino');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'ETHNICITY_CONCEPT_ID', 'NI', 'Hispanic - no information', 44814650, 
    'Hispanic - no information');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'ETHNICITY_CONCEPT_ID', 'NOTHISPANIC', 'Not Hispanic or Latino', 38003564, 
    'Not Hispanic or Latino');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'ETHNICITY_CONCEPT_ID', 'OT', 'Hispanic - other', 44814649, 
    'Hispanic - other');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'ETHNICITY_CONCEPT_ID', 'PR', 'No matching concept', 0, 
    'No matching concept');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PERSON', 'GENDER_CONCEPT_ID', 'OT', 'O', 8521, 
    'OTHER');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PROCEDURE_OCCURRENCE', 'PROCEDURE_TYPE_CONCEPT_ID', 'ORIGPX:MAPPED', 'CPT-4', 38000275, 
    'EHR order list entry');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('PROCEDURE_OCCURRENCE', 'PROCEDURE_TYPE_CONCEPT_ID', 'ORIGPX:MAPPED', 'HCPCS', 38000275, 
    'EHR order list entry');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('VISIT', 'PLACE_OF_SERVICE_CONCEPT_ID', 'IP', 'Inpatient Visit', 9201, 
    'Inpatient Visit');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('VISIT', 'PLACE_OF_SERVICE_CONCEPT_ID', 'OA', 'Outpatient Visit', 9202, 
    'Outpatient Visit');
Insert into OMOP_MAPPING
   (DESTINATION_TABLE, DESTINATION_COLUMN, SOURCE_VALUE, DESTINATION_VALUE, DESTINATION_CODE, 
    DESTINATION_DESC)
 Values
   ('VISIT', 'PLACE_OF_SERVICE_CONCEPT_ID', 'ED', 'Emergency Room Visit', 9203, 
    'Emergency Room Visit');
COMMIT;
